# SQLiLite

- **Category:** [Web Exploitation]
- **Difficulty:** Medium
- **Description:** Can you login to this website?

## 1. Problem Analysis

In this challenege we are given a website we have to try to hack and log into. This challenege is titled **SQLiLite** which you can assume involves SQL probably SQL injection.

## 2. Approach

We are given a simple website that asks us to log in, and we can assume that once we log in, it will give us the flag. If we try the username `user` and a random password such as `password123`, it tells us that we failed to log in; however, at the top of the webpage, it gives us:

```
username: user
password: password123
SQL query: SELECT * FROM users WHERE name='user' AND password='password123'
```

The key here is that it shows us the exact SQL query that is being executed, which means we can exploit this. Since the input we give the login form is saved as a string and used in the SQL query, we can manipulate our input to exploit the way the SQL query is executing. To do this, we first have to assume that we have to log in as an admin; that will give us the most control over the website we log in to. We then have to input `admin' OR '1' = '1`. This essentially does two things: one, it ends the username string that was being used to find a user from the `users` database, and second and more importantly, it adds `OR '1' = 1'` to the SQL query, which breaks it. What it does is add a third requirement for the query to return true; it uses `OR` which would always make the entire query return true if the expression it's evaluating is true, in our case `'1' = '1'` which of course is always true. Since we use `OR` and an expression that is always true, the entire SQL query evaluates to true even if we don't have the password.

## 3. Vulnerability

The key vulnerability we exploited in this challenge was SQL injection, which is a penetration technique that exploits user input that is connected to an SQL database. What we do is we inject malicious code into the input and that code makes its way to the database and alters it or provides us with real login information we can use to get into the website. In this challenge we used malicious code to trick the website into thinking we have authorized permission to enter it because the database thinks we entered the correct information. This is a dangerous vulnerability that software engineers/developers need to be aware of, as it can break a website if they are not careful.

## 4. Flag

After successfully exploiting the login form, we are given the text `Logged in! But can you see the flag, it is in plainsight.` which adds one more step before we can actually get our flag. We have to use inspect element to go into the html code of the website; we can see the hidden flag.

```
<html>
<head></head>
<body><pre>username: admin' OR '1' = '1
password: password123
SQL query: SELECT * FROM users WHERE name='admin' OR '1' = '1' AND password='password123'
</pre>
<h1>Logged in! But can you see the flag, it is in plainsight.</h1>
<p hidden="">Your flag is: picoCTF{************************}</p></body></html>
```

There we can get the flag and solve the challenge!

## 5. Key Takeaways

- **When given a login page in a CTF challenge, be sure to try and see if it's vulnerable to SQL injections.**
- **When building a website or app, please ensure it is protected from SQL injections.**
- **Learn more about SQL queries and how they work.**
