# SSTI1

- **Category:** [Web Exploitation]
- **Difficulty:** Easy
- **Description:** I made a cool website where you can announce whatever you want! Try it out! I heard templating is a cool and modular way to build web apps!

## 1. Problem Analysis

In this challenge we are given a web application to try and hack into to find the flag. For this challenge, it's titled SSTI which stands for Server Side Template Injection, which is how we need to solve this challenge.

## 2. Approach

To solve this challenge, we need to look at the input field of the website and determine what kind of templating engine the website uses. For that we can either use Burp Suite or input `{{7*7}}` into our field. I went for the latter option since Burp Suite is better for more complicated challenges than this easy one but you can still use it. When you input `{{7*7}}` into the field, you don't get {{7*7}} as a string but rather you get the integer 49, indicating that this was passed in as code rather than a string. Knowing this, we can confirm that the site uses Jinja2, a popular templating engine used with Django and Flask.

After we figure that out, we can input some code into the input field to try and find out where the flag is hiding. To do this, we can start with the input `{{request.application.__globals__.__builtins__.__import__('os').popen('ls -R').read()}}`, I will break down the input below:

- `request.application`: This allows us to request different information from the web app, such as built-in objects and core functionalities.

- `__globals__`: This is a special attribute that gives access to all global names.

- `__builtins__`: This is the built-in Python namespace that gives us access to functions like `import`.

- `__import__('os')`: An alternative to `import os` this gives us access to functions that can be run by shell commands.

- `.popen('ls -R')`: `popen` is a function that allows us to run shell commands. `ls -R` allows us to recursively list all files and folders from the current directory.

- `.read()`: Reads the output and displays it to the website.

From this input it gives us the following output:

```
.: __pycache__ app.py flag
requirements.txt ./__pycache__:
app.cpython-38.pyc
```

From this we can conclude that the flag is within the current directory and so we can replace `ls -R` with `cat flag` which displays our flag.

## 3. Vulnerability

The main vulnerability is that the website is poorly built around user input. Since the input does not only display something but also **executes** that input as code, it can be taken advantage of by a hacker. In this challenge the website was using Jinja2 and once a hacker inputs `{{7*7}}` and the template displays 49 instead of a string, you can determine that you can input malicious code like we did in this challenge.

## 4. Flag

Once you input the correct input listed in the Approach section, you get the flag `picoCTF{******************************}`

## 5. Key Takeaways

- **For a challenge involving SSTI always check the input and figure out what engine is being used.**
- **Understand what the malicious code does and how it can be applied elsewhere (legally!).**
- **Try to use **Burp Suite** to solve challenges like this to get some practice.**
